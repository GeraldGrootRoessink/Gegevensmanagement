/*
 * Add identitynote on view
 * 
 * Add identitynote on view based on documentation and properties. 
 * Note: remove old one by hand
 *
 * (c) 2022 Gerald Groot Roessink,  2022-12-16
 * 
 * This work is licensed under the HUMANS Licence described below.
 * 
 * The HUMANS (Help Us Make Archi Noteworthy & Sustainable) licence goal is to bring happiness
 * to both Archi users and developers. 
 *
 * The only restrictions that apply are:
 *  - You can't redistribute this script.
 *  - You can't use this script for commercial purposes 
 * 
 */
 
 
// Show output in the console
console.show();
console.clear();

var vw_selection = selection.filter("view");

if(vw_selection.size() < 1 ) {
  window.alert("Nothing to be copied. Please select one or more views");
  exit();
}


vw_selection.each(function(view) {

	// remove the old one by hand. next line will remove all notes
	//$(view).find('diagram-model-note').each(function(i) {i.delete()});
	
	identitytext="naam:\t\t"+view.name+"\nomschrijving:\t"+view.documentation; 
	//Add properties belonging to view 
	for(var j = 0; j < $(view).prop().length; j++) {
		identitytext=identitytext+"\n"+$(view).prop()[j]+":\t\t"+$(view).prop($(view).prop()[j]);
	};
//	console.log(identitytext);	

	var identitynote = view.createObject("diagram-model-note", 10, 10, 350, 100);
	identitynote.setText(identitytext) ;

	console.log ("identitynote added on view:", view);	

});
